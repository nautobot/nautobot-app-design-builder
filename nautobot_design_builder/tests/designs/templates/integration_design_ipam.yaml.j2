---

tags:
    - "!create_or_update:name": "VRF Prefix"
      "slug": "vrf_prefix"
    - "!create_or_update:name": "VRF Interface"
      "slug": "vrf_interface"

prefixes:
    - "!create_or_update:prefix": "{{ p2p_prefix }}"
      status__name: "Reserved"

vrfs:
  - "!create_or_update:name": "{{ p2p_asn }}:{{ get_customer_id(customer_name, p2p_asn) }}"
    description: "VRF for customer {{ customer_name }}"
    prefixes:
      - "!next_prefix":
          identified_by:
            tags__name: "VRF Prefix"
          prefix: "{{ p2p_prefix }}"
          length: 30
        status__name: "Reserved"
        tags:
          - {"!get:name": "VRF Prefix"}
        "!ref": "p2p_prefix"
